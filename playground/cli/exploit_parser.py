import argparse

# ------------------------------------------------------------------------------------------------
exploit_types = ['xss', 'csrf', 'cswsh']

# ------------------------------------------------------------------------------------------------
base_parser = argparse.ArgumentParser(prog='exploit')

base_subparser = base_parser.add_subparsers(
    title='Exploit subcommands', help='Commands for configuring exploits for crusade')

# ------------------------------------------------------------------------------------------------
search_parser = base_subparser.add_parser('search', help='Search for available exploits') 
search_parser.set_defaults(func='exploit_search')

search_parser.add_argument(
    '-t', '--type', type=str, choices=exploit_types,
    help='Specify exploit type for search')

search_parser.add_argument(
    'query', type=str, help='Exploit search query - use "*" as wildcard')

# ------------------------------------------------------------------------------------------------
list_parser = base_subparser.add_parser('list', help='List configured exploits for crusade') 
list_parser.set_defaults(func='exploit_list')

list_parser.add_argument(
    '-t', '--type', type=str, choices=exploit_types,
    help='Filter configured exploits by type')

list_parser.add_argument(
    'query', type=str, help='Filter configured exploits by query - use "*" as wildcard')

# ------------------------------------------------------------------------------------------------
add_parser = base_subparser.add_parser('add', help='Add specified exploit to crusade') 
add_parser.set_defaults(func='exploit_add')

add_parser.add_argument(
    'name', type=str, help='Name/ID of exploit to add and configure ("type/name")')

# ------------------------------------------------------------------------------------------------
remove_parser = base_subparser.add_parser('remove', help='Remove specified exploit from crusade') 
remove_parser.set_defaults(func='exploit_remove')

remove_parser.add_argument(
    'id', type=str, help='ID of exploit to remove - use "*" as wildcard')

# ------------------------------------------------------------------------------------------------
edit_parser = base_subparser.add_parser('edit', help='Edit configured exploit in crusade') 
edit_parser.set_defaults(func='exploit_edit')

edit_parser.add_argument(
    'id', type=str, help='ID of exploit in crusade to reconfigure')
